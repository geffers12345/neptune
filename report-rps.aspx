<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="report-rps.aspx.cs" Inherits="Seabase.report_rps" %>

<!DOCTYPE html>


<!DOCTYPE html>
<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:p="urn:schemas-microsoft-com:office:powerpoint" xmlns:a="urn:schemas-microsoft-com:office:access" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" xmlns:b="urn:schemas-microsoft-com:office:publisher" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:c="urn:schemas-microsoft-com:office:component:spreadsheet" xmlns:odc="urn:schemas-microsoft-com:office:odc" xmlns:oa="urn:schemas-microsoft-com:office:activation" xmlns:html="http://www.w3.org/TR/REC-html40" xmlns:q="http://schemas.xmlsoap.org/soap/envelope/" xmlns:D="DAV:" xmlns:x2="http://schemas.microsoft.com/office/excel/2003/xml" xmlns:ois="http://schemas.microsoft.com/sharepoint/soap/ois/" xmlns:dir="http://schemas.microsoft.com/sharepoint/soap/directory/" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" xmlns:udc="http://schemas.microsoft.com/data/udc" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:sub="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/" xmlns:ec="http://www.w3.org/2001/04/xmlenc#" xmlns:sp="http://schemas.microsoft.com/sharepoint/" xmlns:sps="http://schemas.microsoft.com/sharepoint/soap/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:udcs="http://schemas.microsoft.com/data/udc/soap" xmlns:udcxf="http://schemas.microsoft.com/data/udc/xmlfile" xmlns:udcp2p="http://schemas.microsoft.com/data/udc/parttopart" xmlns:wf="http://schemas.microsoft.com/sharepoint/soap/workflow/" xmlns:dsss="http://schemas.microsoft.com/office/2006/digsig-setup" xmlns:dssi="http://schemas.microsoft.com/office/2006/digsig" xmlns:mdssi="http://schemas.openxmlformats.org/package/2006/digital-signature" xmlns:mver="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns:mrels="http://schemas.openxmlformats.org/package/2006/relationships" xmlns:spwp="http://microsoft.com/sharepoint/webpartpages" xmlns:ex12t="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:ex12m="http://schemas.microsoft.com/exchange/services/2006/messages" xmlns:pptsl="http://schemas.microsoft.com/sharepoint/soap/SlideLibrary/" xmlns:spsl="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService" xmlns:Z="urn:schemas-microsoft-com:" xmlns:st="&#1;" xmlns="http://www.w3.org/TR/REC-html40">
    <head>
        <title>RFP Report</title>
        <style type="text/css">
        body{
            font-family: Calibri;
        }
        table{
            border-collapse:collapse;
        }
       /* td{ border-color: #000;}*/
            
        td.rpsam12 { font-family: Arial, verdana, Helvetica,  sans-serif; font-size:12px;}
        td.rpsam11 { font-family: Arial, verdana, Helvetica,  sans-serif; font-size:11px;}
        td.rpsam10 { font-family: Arial, verdana, Helvetica,  sans-serif; font-size:10px;}
        
            tr.border-tr td{
                border:1px solid #000;
            }
            td.font11 { font-size:10pt !important; }
            td.font12 { font-size:12pt !important; }

            td.reportrps10 { font-size:9pt !important; }
            td.reportrps11 { font-size:11pt !important; }
            td.reportrps12 { font-size:12pt !important; }
            @page{
                size: 11.69in 8.27in;
                margin-top: 0.1in;
                margin-left: 0.2in;
                margin-right: 0.2in;
                margin-bottom: 0in;
            }


            @page Section1 {
                mso-header-margin:0in;
                mso-footer-margin:0in;
                mso-page-orientation: landscape;
                margin-top: 0.1in;
                margin-right: .2in;
                margin-left: .2in;
                mso-header: h1;
                mso-footer: f1;

            }
            div.Section1 { page:Section1;}
            table#hrdftrtbl
            {
                width:100%;
                margin:0in auto 0in;
            }
            p.MsoFooter, li.MsoFooter, div.MsoFooter
            {
                margin:0in;
                margin-bottom:.0001pt;
                mso-pagination:widow-orphan;
                tab-stops:center 3.0in right 6.0in;
                font-size:12.0pt;
            }
             #bottom-margin{
                height: 0 !important;
            }

             a:hover {
                 cursor: pointer;
             }

        </style>
         <style>
            v\:* {behavior:url(#default#VML);}
            o\:* {behavior:url(#default#VML);}
            w\:* {behavior:url(#default#VML);}
            .shape {behavior:url(#default#VML);}
        </style>
          <!--[if gte mso 9]>
            <xml>
                <w:WordDocument>
                <w:View>Print</w:View>
                <w:Zoom>100</w:Zoom>
                <w:DoNotOptimizeForBrowser/>
                </w:WordDocument>
            </xml> 
        <![endif]-->
    </head>
    <body id="page-content">
        <div class="Section1">
            <table id="hrdftrtbl" cellspacing="1" cellpadding="0" align="center" border="0" style="border:none;width: 11.49in !important;">
                <tr height="0">
                    <td style="width: 0.42in;"></td>
                    <td style="width: 0.65in;"></td>
                    <td style="width: 0.15in;"></td>
                    <td style="width: 0.64in;"></td>
                    <td style="width: 1.10in;"></td>
                    <td style="width: 0.52in;"></td>
                    <td style="width: 0.38in;"></td>
                    <td style="width: 0.67in;"></td>
                    <td style="width: 0.59in;"></td>
                    <td style="width: 0.94in;"></td>
                    <td style="width: 0.75in;"></td>
                    <td style="width: 0.53in;"></td>
                    <td style="width: 0.52in;"></td>
                    <td style="width: 0.71in;"></td>
                    <td style="width: 0.72in;"></td>
                    <td style="width: 0.72in;"></td>
                    <td style="width: 1.31in;"></td>
                </tr>
                <tr><td colspan="17" valign=top class="font11"><b>FM-POEA-04-EF-06-B</b></td></tr>
                <tr><td colspan="17" valign=top class="font11"><b>Effective Date:</b></td></tr>
                <tr><td colspan="17" valign=top class="font11"><b>&nbsp;</b></td></tr>
                <tr><td colspan="17" valign=top class="font11"><b>PHILIPPINE OVERSEAS EMPLOYMENT ADMINISTRATION</b></td></tr>
                <t>
                    <td colspan="13" valign=top class="font11"><b>Seabased Employment Accreditation and Processing Center</b></td>
                    <td colspan="4" valign=top class="font11"><b>* RFP No:____________________________________</b></td>
                </tr>
                <tr>
                    <td colspan="13" valign=top class="font11"><b>SEABASED PROCESSING DIVISION</b></td>
                    <td colspan="4"  valign=top class="font11"><b>* Date Received:_______________________________</b></td>
                </tr>
                <tr height="35"><td colspan="17" valign=top align="center" class="font12"><b>
                    <a role="button" id="dl-rps-printable" title="Click to download file Microsoft Word Fortmat">
                        REQUEST FOR PROCESSING (REGULAR)</a></b></td></tr>
                <tr height="33">
                    <td colspan="5" class="font11"><b></b></td>
                    <td class="font11" style="vertical-align:middle !important"><b style="vertical-align: middle !important;"><img src="http://www.conautic.com.ph/iris/img/rectangle_dark.jpg" height="22" width="40" style="vertical-align: middle !important;" valign="middle"/></b></td>
                    <td colspan="6" class="font11" style="vertical-align:middle !important">&nbsp;<b style="vertical-align: middle !important;"><b>ENGAGE SEAFARER/S</b></td>
                    <td class="font11" style="vertical-align:middle !important"><b style="vertical-align: middle !important;"><img src="http://www.conautic.com.ph/iris/img/rectangle_dark_x.jpg" height="22" width="40" style="vertical-align: middle !important;" valign="middle"/></b></td>
                    <td colspan="4" class="font11" style="vertical-align:middle !important"><b style="vertical-align: middle !important;">&nbsp;<b>RE-ENGAGED/CADET/PRV</b></td>
                </tr>
                <tr height="30">
                    <td  colspan="2" valign=bottom class="font11"><b>Name of Agency:</b></td>
                    <td colspan="6" valign=bottom class="font11" style="border-bottom:1px solid #000;"><b>CONAUTIC MARITIME INC.</b></td>
                    <td colspan="9" valign=bottom class="font11"><b></b></td>
                </tr>
                <tr>
                    <td colspan="4" valign=bottom class="font11" ><b>Name of Accredited Principal:</b></td>
                    <td colspan="4" valign=bottom class="font11" style="border-bottom:1px solid #000;"><b id="principal-view"></b></td>
                    <td colspan="9" valign=bottom class="font11"><b></b></td>
                </tr>
                <tr>
                    <td colspan="2" valign=bottom class="font11"><b>Name of Vessel:</b></td>
                    <td colspan="6" valign=bottom class="font11" style="border-bottom:1px solid #000;"><b id="vessel-view">Ammon</b></td>
                    <td colspan="9" valign=bottom class="font11"><b></b></td>
                </tr>
                <tr><td colspan="17">&nbsp;</td></tr>
                <tr height="40" class="border-tr">
                    <td colspan="4" class=reportrps11 align=center><b>NAME OF SEAFARER</b></td>
                    <td colspan="3" class=reportrps11 align=center><b>e-REGISTRATION<br>NUMBER</b></td>
                    <td colspan="2" class=reportrps11 align=center><b>Seamans #</b></td>
                    <td class=reportrps11 align=center><b>GENDER</b></td>
                    <td colspan="2" class=reportrps11 align=center><b>POSITION</b></td>
                    <td colspan="2" class=reportrps11 align=center><b>SALARY</b></td>
                    <td colspan="2" class=reportrps11 align=center><b>CONTRACT<br>DURATION<br>(Mo. / Day)</b></td>
                    <td class=reportrps11 align=center><b>ACTION TAKEN</b></td>
                </tr>
                <tbody id="rps-tbody">

                </tbody>
                <tr>
                    <td colspan="9" valign=top class="font11"><b>Submitted By:</b></td>
                    <td colspan="8"  valign=top class="font11"><b>Requesting Party:</b></td>
                </tr>
                <tr height="30">
                    <td valign=top class="font11"><b>&nbsp;</b></td>
                    <td colspan="5" align="center" valign=bottom class="font11">
                        <b></b>
                    </td>
                    <td colspan="6" valign=top class="font11"><b>&nbsp;</b></td>
                    <td colspan="3" align="center" valign=bottom class="font11">
                        <b></b>
                    </td>
                    <td colspan="2" valign=top class="font11"><b>&nbsp;</b></td>
                </tr>
                <tr>
                    <td valign=top class="rpsam11"><b></b></td>
                    <td colspan="5" align="center" valign=top class="font11" style="border-top:1px solid #000;"><b>SIGNATURE <br>(<span id="asignatory"></span>)</b></td>
                    <td colspan="6" valign=top class="rpsam11"><b></b></td>
                    <td colspan="3" align="center" valign=top class="font11" style="border-top:1px solid #000;"><b>Authorized Signatories</b></td>
                    <td colspan="2" valign=top class="rpsam11"><b></b></td>
                </tr>
                <tr>
                    <td style="border-bottom:1px dotted #000;" colspan="7">&nbsp;</td>
                    <td style="border-bottom:1px dotted #000;" colspan="3">&nbsp;</td>
                    <td style="border-bottom:1px dotted #000;" colspan="7">&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="7" valign=top class="reportrps11"></td>
                    <td colspan="3" valign=top align="center" class="reportrps11"><b>FOR POEA USE ONLY</b></td>
                    <td colspan="7" valign=top class="reportrps11"></td>
                </tr>
                <tr>
                    <td colspan="12" valign=bottom class="reportrps11"><b><u>ORDER OF PAYMENT</u></b></td>
                    <td colspan="5" valign=top class="reportrps10"><b>( ) On hold prior to completion of requirements</b></td>
                </tr>
                <tr height="30">
                    <td colspan="12" valign=top class="reportrps11"></td>
                    <td colspan="5" valign=top class="reportrps10"><b>( ) Documents verified and found to be complete & in order</b></td>
                </tr>
                 <tr>
                    <td valign=top class="font11"><b>&nbsp;</b></td>
                    <td colspan="16" align="left" valign=top class="font11"><b>Please accept from the above-named Agency the payment</b></td>
                </tr>
                <tr>
                    <td valign=top class="font11"><b>&nbsp;</b></td>
                    <td colspan="16" align="left" valign=top class="font11"><b>For the Processing Fee of ________Seafarer(s)</b></td>
                </tr>
                <tr>
                    <td colspan="17">&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="6" valign=bottom class="font11"><b>( ) POEA &nbsp;&nbsp;&nbsp;&nbsp;________&nbsp;&nbsp;&nbsp;&nbsp;________&nbsp;&nbsp;&nbsp;&nbsp;____________</b></td>
                    <td colspan="6">&nbsp;</td>
                    <td colspan="4">&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="4" valign=top class="font11"><b>&nbsp;</b></td>
                    <td  colspan="1" valign="top" align="center" class="font11"><b>Evaluator</b></td>
                    <td colspan="7">&nbsp;</td>
                    <td colspan="4" align="center" style="border-top:1px solid #000;" class="font11"><b>SEAPC Official Signatory</b></td>
                    <td>&nbsp;</td>
                </tr>
                <tr height="10">
                    <td colspan="17" style="border-bottom:1px solid #000;"></td>
                </tr>
                <tr>
                    <td colspan="17" class="reportrps11"><b>PAYMENT OF FEES</b></td>
                </tr>
                <tr height="20">
                    <td colspan="4" class="reportrps11"><b></b></td>
                    <td colspan="8" class="reportrps11"><b>Processing Fee O.R. No:_________________________</b></td>
                    <td colspan="5" class="reportrps11"><b>OWWA Contribution O.R. NO.:_________________________</b></td>
                </tr>
                <tr height="25">
                    <td colspan="4" class="reportrps11"><b></b></td>
                    <td colspan="4" class="reportrps11" align="center" style="border-bottom:1px solid #000;"><b></b></td>
                    <td colspan="4" class="reportrps11"><b></b></td>
                    <td colspan="4" class="reportrps11" align="center" style="border-bottom:1px solid #000;"><b></b></td>
                    <td>&nbsp;</td>
                </tr>
                 <tr>
                    <td colspan="4" class="reportrps11"><b></b></td>
                    <td colspan="4" class="reportrps11" align="center"><b>POEA Cashier/Collecting Officer</b></td>
                    <td colspan="4" class="reportrps11"><b></b></td>
                    <td colspan="4" class="reportrps11" align="center"><b>OWWA CASHIER/Collecting Officer</b></td>
                    <td>&nbsp;</td>
                </tr>
                <tr height="15">
                    <td colspan="17" class="reportrps11"></td>
                </tr>
                <tr>
                    <td colspan="17" valign="bottom" class="reportrps10"><b>* To be filled-up by POEA</b></td>
                </tr>
                <tr>
                    <td colspan="17" valign="bottom" class="reportrps10"><b>** Please reflect SALARY MODE (DAY/Month)</b></td>
                </tr>
            </table>                            
        </div>
    </body>
<script src="Scripts/jquery-3.2.1.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="scripts/FileSaver.js"></script>
<script src="scripts/jquery.wordexport.js"></script>
<script src="Scripts/helpers.js"></script>
<script src="Scripts/sweetalert2.min.js"></script>
<script src="Scripts/validator.js"></script>
<script src="scripts/WebForms/maintenance.js"></script>
<script>
    var arr = [];

    $(document).ready(function () {
        var url = new URL(window.location.href);
        arr = url.searchParams.get("ids").split(',');

        crewRps(parseInt(url.searchParams.get("vesselId")));
        vessel_info(parseInt(url.searchParams.get("vesselId")));

        $('#asignatory').text(url.searchParams.get("submitted"));
    });

    function crewRps(vesselId) {
        $('#rps-tbody').empty().append("<tr class=\"loading\"><td colspan=\"20\">Please select a Vessel</td></tr>");
            
        (new http).post("crews.aspx/crewRps", {
            vesselID: vesselId
        }).then(function (response) {

            response.d.map(item => {

                var html = "";
                //getting numbers

                var today = getManilaTime().split(',')[0];
                var d = today.split('/');

                var d0 = d[0].length > 1 ? d[0] : '0' + d[0];
                var d1 = d[1].length > 1 ? d[1] : '0' + d[1];

                var formattedDate = d[2] + '-' + d0 + '-' + d1;

                (new http).post("applicant.aspx/numbers", {
                    id: item.ID,
                    date: formattedDate
                }).then(function (response) {

                    var items = response.d.map(n => {

                        return new Promise(function (resolve, reject) {

                            if (arr.includes(item.ID.toString())) {
                                html += '<tr bgcolor=ffffff class="border-tr" height="60">' +
                                            '<td colspan="4" class=reportrps11>' +
                                                '&nbsp;' + item.Lastname + ', ' + item.Firstname + '</td>' +
                                            '<td colspan="3" class=reportrps11 align=center>E-Reg#' + n.Eregistration + '</td>' +
                                            '<td colspan="2" class=reportrps11 align=center>' + n.Seaman + '</td>' +
                                            '<td class=reportrps10 align=center>' + item.Sex + '</td>' +
                                            '<td colspan="2" class=reportrps11 align="center">' + item.Rank + '</td>' +
                                            '<td colspan="2"class=reportrps11 align=center></td>' +
                                            '<td colspan="2" class=reportrps11 align="center" style="width: 0.72in;"></span>' +
                                            '</td>' +
                                            '<td class=reportrps11>&nbsp;</td>' +
                                        '</tr>';

                                    $('#rps-tbody').append(html);
                            }

                            resolve();
                        });
                    });

                    Promise.all(items).then(function () {
                        $('.loading').remove();
                    });

                }).run();
            });
        }).run();
    }

    function vessel_info(id) {

        (new http).post("_vessels.aspx/find", {
            id: id
        }).then(function (response) {

            var item = response.d[0];

            $('#vessel-view').text(item.Name);
            $('#principal-view').text(item.Principal);

        }).run();
    }

     function getManilaTime() {
        var options = {
            timeZone: 'Asia/Manila',
            year: 'numeric', month: 'numeric', day: 'numeric',
            hour: 'numeric', minute: 'numeric', second: 'numeric',
        },

        formatter = new Intl.DateTimeFormat([], options);
        return formatter.format(new Date())
    }

    $("#dl-rps-printable").click(function(event) {
        $("#page-content").wordExport('RPS Report');
    });

</script>
</html>
